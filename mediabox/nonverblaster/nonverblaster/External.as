package nonverblaster {		import flash.display.*;	import flash.events.*;	import flash.utils.*;	import flash.external.*;	import flash.text.*;		public class External extends Sprite{				private var output		:TextField;		private var main		:MovieClip;		private var _stage		:Stage;				public function External($stage, $main){			main = $main;			//output = main.textFeld;			output = new TextField();			init();			_stage = $stage;			if(_stage != null){				_stage.addEventListener(MouseEvent.CLICK, mouseHandler);			}		}		private function mouseHandler(e:MouseEvent){			if (ExternalInterface.available) {				ExternalInterface.call("nonverBlasterClickHandler");				_stage.removeEventListener(MouseEvent.CLICK, mouseHandler);			}		}		private function init(){			if (ExternalInterface.available) {                try {                    ExternalInterface.addCallback("sendToActionScript", receivedFromJavaScript);				} catch (error:SecurityError) {					output.appendText("A SecurityError occurred: " + error.message + "\n");				} catch (error:Error) {					output.appendText("An Error occurred: " + error.message + "\n");                }            } else {                output.appendText("External interface is not available for this container.");            }		}		private function receivedFromJavaScript(value:String){			output.appendText(value + "\n");			//ExternalInterface.call("alert", value);			doAction(value);		}		private function doAction(value){			switch(value.split(":")[0]){				case "play":				if(main.started == false || main.isComplete == true){					main.playMedia();				} else if(main.isPlaying == false){					main.resumeMedia();				}				break;				case "pause":				if(main.started == true){					main.pauseMedia();				}				break;								case "seekToSecond":				if(main.started == true || main.isComplete == false){					main.seekToSecond(Number(value.split(':')[1]));				}				break;								case "seekToPercent":				if(main.started == true || main.isComplete == false){					main.setPlayingProgress(Number(value.split(':')[1]) / 100);				}				break;								case "toggleSound":				main.toggleVolume();				break;								case "volume":				main.setVolume(Number(value.split(":")[1]) / 100);				break;								case "switchColor":				Glo.bal.controlColor = value.split(":")[1];				main.setTints();				break;								case "resetAll":				main.resetAll();				break;								case "switch":				main.switchMedia(value.split("switch:")[1]);				break;								case "getPlayingProgress":				var playingProgress = 0;				try {					playingProgress = main.getPlayingProgress();				} catch (e:Error){};								ExternalInterface.call("recievePlayingProgress", playingProgress);				break;								case "getLoadingProgress":				var loadingProgress = 0;				try {					loadingProgress = main.getLoadingProgress();				} catch (e:Error){};								ExternalInterface.call("recieveLoadingProgress", loadingProgress);				break;							}		}		public function callJsOnComplete(){			var jsOnComplete = Glo.bal.jsOnComplete;			if(jsOnComplete != ""){				var functionName = jsOnComplete.split(",")[0];				var functionParams = jsOnComplete.split(functionName + ",")[1];				functionParams = functionParams.split(",");				//log("***********" + functionParams);				if(ExternalInterface.available){					// Es können bis zu 8 Parameter für die Funktion übergeben werden					ExternalInterface.call(functionName, functionParams[0], functionParams[1], functionParams[2], functionParams[3], functionParams[4], functionParams[5], functionParams[6], functionParams[7], functionParams[8]);				}			}		}		public function callJsOnStart(){			var jsOnStart = Glo.bal.jsOnStart;			if(jsOnStart != ""){				var functionName = jsOnStart.split(",")[0];				var functionParams = jsOnStart.split(functionName + ",")[1];				functionParams = functionParams.split(",");				//log("***********" + functionParams);				if(ExternalInterface.available){								// Es können bis zu 8 Parameter für die Funktion übergeben werden					ExternalInterface.call(functionName, functionParams[0], functionParams[1], functionParams[2], functionParams[3], functionParams[4], functionParams[5], functionParams[6], functionParams[7], functionParams[8]);				}			}					}	}}